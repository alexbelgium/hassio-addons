#!/usr/bin/with-contenv bashio
# shellcheck shell=bash
set -euo pipefail

# ==============================================================================
# Home Assistant Add-on: NetBird Server
# Runs the NetBird Signal service
# ==============================================================================

SIGNAL_PORT=8083
SIGNAL_GRPC_PORT=10000
LOG_LEVEL="info"

bashio::log.info "Starting NetBird Signal on port ${SIGNAL_PORT} (gRPC: ${SIGNAL_GRPC_PORT})..."
exec /usr/local/bin/netbird-signal run \
  --port "$SIGNAL_PORT" \
  --grpc-port "$SIGNAL_GRPC_PORT" \
  --log-level "$LOG_LEVEL" \
  --log-file console
