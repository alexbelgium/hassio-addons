#!/usr/bin/with-contenv bashio
# shellcheck shell=bash
set +e

if ! bashio::config.true 'wireguard_enabled'; then
    exit 0
fi

wireguard_config="${WIREGUARD_CONFIG:-}"

if [ -z "${wireguard_config}" ] && [ -f /var/run/s6/container_environment/WIREGUARD_CONFIG ]; then
    wireguard_config="$(cat /var/run/s6/container_environment/WIREGUARD_CONFIG)"
fi

if [ -n "${wireguard_config}" ]; then
    wg-quick down "${wireguard_config}" >/dev/null 2>&1 || true
fi
